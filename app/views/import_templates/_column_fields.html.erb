<div class="border border-gray-200 rounded-lg p-4 column-field" 
     data-column-id="<%= column.persisted? ? column.id : 'new' %>"
     draggable="true"
     data-action="dragstart->column-manager#dragStart dragend->column-manager#dragEnd dragover->column-manager#dragOver drop->column-manager#drop">
  <div class="flex justify-between items-start mb-3">
    <div class="flex items-center space-x-2">
      <div class="drag-handle cursor-move text-gray-400 hover:text-gray-600" 
           data-action="mousedown->column-manager#handleMouseDown">
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path d="M7 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM7 8a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM7 14a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM13 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM13 8a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM13 14a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path>
        </svg>
      </div>
      <h4 class="font-medium text-gray-900">
        Column <%= column.persisted? ? column.column_number : 'New' %>
      </h4>
    </div>
    <button type="button" 
            class="remove-column text-red-600 hover:text-red-800 text-sm font-medium"
            data-confirm="Are you sure? This will permanently delete the column and all its data.">
      Remove
    </button>
  </div>
  
  <div class="grid grid-cols-3 gap-4">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Name</label>
      <input type="text" 
             name="template_columns[<%= column.persisted? ? column.id : 'new_' + SecureRandom.hex(4) %>][name]" 
             value="<%= column.name %>"
             class="column-name block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
             required>
    </div>
    
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Data Type</label>
      <select name="template_columns[<%= column.persisted? ? column.id : 'new_' + SecureRandom.hex(4) %>][data_type]" 
              class="column-data-type block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
              required>
        <option value="">Select type...</option>
        <% %w[string number date boolean].each do |type| %>
          <option value="<%= type %>" <%= 'selected' if column.data_type == type %>>
            <%= type.capitalize %>
          </option>
        <% end %>
      </select>
    </div>
    
    <div class="flex items-end">
      <label class="flex items-center">
        <input type="checkbox" 
               name="template_columns[<%= column.persisted? ? column.id : 'new_' + SecureRandom.hex(4) %>][required]" 
               value="1"
               class="column-required rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"
               <%= 'checked' if column.required? %>>
        <span class="ml-2 text-sm text-gray-700">Required</span>
      </label>
    </div>
  </div>
  
  <% if column.persisted? %>
    <input type="hidden" name="template_columns[<%= column.id %>][id]" value="<%= column.id %>">
  <% end %>
</div>